<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>class helper setting</title>
    <link rel="shortcut icon" href="/static/favicon.ico">
    <link rel="stylesheet" type="text/css" href="/static/config.css">
    <script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js"></script>
    <script>
        // 登出
        $(document).ready(function() {
            $("#logout").click(function(){
                $.post('/users/logout',
                    function(data) {
                        // console.log(data)
                        if (data.hasOwnProperty('error')) {
                            alert(data['error'])
                            // console.log(data['error']);
                        }
                        else
                        {
                            $(location).attr('href', '/');
                            // console.log(data);
                        } 
                    }
                )
            })
        })

        // 提交
        $(document).ready(function(){
            $("#submit").click(function(){
                // 判断每个复选框的状态
                if ($('#switch_pushplus').is(':checked')) {
                    var switch_pushplus = true
                }
                else
                {
                    var switch_pushplus = false
                }
                if ($('#switch_telegram').is(':checked')) {
                    var switch_telegram = true
                }
                else
                {
                    var switch_telegram = false
                }
                if ($('#switch_weather').is(':checked')) {
                    var switch_weather = true
                }
                else
                {
                    var switch_weather = false
                }
                if ($('#switch_pushplus_rightnow').is(':checked')) {
                    var switch_pushplus_rightnow = true
                }
                else
                {
                    var switch_pushplus_rightnow = false
                }
                if ($('#switch_telegram_rightnow').is(':checked')) {
                    var switch_telegram_rightnow = true
                }
                else
                {
                    var switch_telegram_rightnow = false
                }
                
                // 提交内容
                $.post('/submit',
                    {
                        'name': $("#user_name").val(),
                        'openid': $("#openid").val(),
                        'xh': $("#xh").val(),
                        'pushplustoken': $("#pushplustoken").val(),
                        'tgtoken': $("#tgtoken").val(),
                        'tg_user_id' : $("#tg_user_id").val(),
                        'switch_pushplus' : switch_pushplus,
                        'switch_telegram': switch_telegram,
                        'switch_weather': switch_weather,
                        'switch_pushplus_rightnow': switch_pushplus_rightnow,
                        'switch_telegram_rightnow': switch_telegram_rightnow
                    },
                    function (data) {
                        if (data.hasOwnProperty('error')) {
                            alert(data.error)
                        }
                        else
                        {
                            alert(data['result'])
                        }
                    }
                )
            })
        });

        // 回车登录
        $(document).keyup(function(event){
            if (event.keyCode == 13) {
                $("#submit").click(function(){
                    // 判断每个复选框的状态
                    if ($('#switch_pushplus').is(':checked')) {
                        var switch_pushplus = true
                    }
                    else
                    {
                        var switch_pushplus = false
                    }
                    if ($('#switch_telegram').is(':checked')) {
                        var switch_telegram = true
                    }
                    else
                    {
                        var switch_telegram = false
                    }
                    if ($('#switch_weather').is(':checked')) {
                        var switch_weather = true
                    }
                    else
                    {
                        var switch_weather = false
                    }
                    if ($('#switch_pushplus_rightnow').is(':checked')) {
                        var switch_pushplus_rightnow = true
                    }
                    else
                    {
                        var switch_pushplus_rightnow = false
                    }
                    if ($('#switch_telegram_rightnow').is(':checked')) {
                        var switch_telegram_rightnow = true
                    }
                    else
                    {
                        var switch_telegram_rightnow = false
                    }
                    
                    // 提交内容
                    $.post('/submit',
                        {
                            'name': $("#user_name").val(),
                            'openid': $("#openid").val(),
                            'xh': $("#xh").val(),
                            'pushplustoken': $("#pushplustoken").val(),
                            'tgtoken': $("#tgtoken").val(),
                            'tg_user_id' : $("#tg_user_id").val(),
                            'switch_pushplus' : switch_pushplus,
                            'switch_telegram': switch_telegram,
                            'switch_weather': switch_weather,
                            'switch_pushplus_rightnow': switch_pushplus_rightnow,
                            'switch_telegram_rightnow': switch_telegram_rightnow
                        },
                        function (data) {
                            if (data.hasOwnProperty('error')) {
                                alert(data.error)
                            }
                            else
                            {
                                alert(data['result'])
                            }
                        }
                    )
                })
            }
        });
    </script>
</head>
<body>
    <div class="main-box">
        <div class="title">Class Helper</div>
        <div class="ep-box">
            <div class="flex">
                <p>name</p>
                <input type="text" id="user_name" value="{{ user_name }}">
            </div>
            <div class="flex">
                <p>openid</p>
                <input type="text" id="openid" value="{{ openid }}">
            </div>
            <div class="flex">
                <p>xh</p>
                <input type="text" id="xh" value="{{ xh }}">
            </div>
            <div class="flex">
                <p>pushplus token</p>
                <input type="text" id="pushplustoken" value="{{ pushplustoken }}">
            </div>
            <div class="flex">
                <p>telegram bot token</p>
                <input type="text" id="tgtoken" value="{{ tgtoken }}">
            </div>
            <div class="flex">
                <p>telegram user id</p>
                <input type="text" id="tg_user_id" value="{{ tg_user_id }}">
            </div>

            <!-- 选择框 -->
            <div class="check">
                <div class="check-box">
                    <div class="check-left-box">pushplus</div>
                    <input type="checkbox" class="checkbox-right-box" id="switch_pushplus" {{ switch_pushplus }}>
                </div>
                <div class="check-box">
                    <div class="check-left-box">pushplus push rightnow</div>
                    <input type="checkbox" class="checkbox-right-box" id="switch_pushplus_rightnow" {{ switch_pushplus_rightnow }}>
                </div>
                <div class="check-box">
                    <div class="check-left-box">telegram</div>
                    <input type="checkbox" class="checkbox-right-box" id="switch_telegram" {{ switch_telegram }}>
                </div>
                <div class="check-box">
                    <div class="check-left-box">telegram push rightnow</div>
                    <input type="checkbox" class="checkbox-right-box" id="switch_telegram_rightnow" {{ switch_telegram_rightnow }}>
                </div>
                <div class="check-box">
                    <div class="check-left-box">weather</div>
                    <input type="checkbox" class="checkbox-right-box" id="switch_weather" {{ switch_weather }}>
                </div>
            </div>
        </div>
        <div class="flex-button">
            <button id="submit" class="ts">submit</button>
            <button id="logout" class="ts">logout</button>
        </div>
    </div>
    <div class="bt">.</div>
</body>
</html>